from utils import get_metrics, process_img
from matplotlib import pyplot as plt
import lpips
import json

# loss_fn = lpips.LPIPS(net='alex')

# init_image, input_image = process_img("hotdog.png", 512)
# init_image2, input_image2 = process_img("hotdog2.png", 512)
# init_image3, input_image3 = process_img("hotdog3.png", 512)
# print(f"init_image : {init_image.shape}, input_image : {input_image.shape}")

# lpips, psnr, psnr1 = get_metrics(init_image, init_image2, loss_fn)

# print(f"22 lpips : {lpips}, psnr : {psnr} , psnr1 : {psnr1}")

# lpips, psnr, psnr1 = get_metrics(init_image, init_image3, loss_fn)

# print(f"33 lpips : {lpips}, psnr : {psnr} , psnr1 : {psnr1}")

record1 = {"lpips": [0.6954038937886556, 0.2697709649801254, 0.43819576501846313, 0.13689794143040976, 0.1383697564403216, 0.3579392333825429, 0.2908436059951782, 0.07898901651302974, 0.10219700634479523, 0.10459025949239731, 0.051693188647429146, 0.0627116064230601, 0.07776401937007904, 0.05968674272298813, 0.10176533957322438], "psnr": [11.863844662335461, 17.512541913179167, 13.562247108147554, 20.102691890921516, 19.237660494019803, 14.084057323945641, 15.281570226714999, 23.149473406871582, 21.254242102346826, 20.53406704430706, 26.024710200167366, 25.03239778046144, 23.1692938939924, 22.382530392649755, 21.010205583467293]}
record2 = {"lpips": [0.7223193764686584, 0.32185761630535126, 0.18754181563854216, 0.23902276754379273, 0.20566425919532777, 0.07979931086301803, 0.06363263577222825, 0.07380177676677704, 0.1031581550836563, 0.05082325041294098, 0.08042287975549697, 0.08279427438974381, 0.05665784701704979, 0.057280772179365155], "psnr": [12.385264705618045, 13.793654557877337, 18.034058342501616, 16.899598929868414, 17.27351791677686, 20.958051988764037, 25.40337971797561, 22.034893537524084, 21.43148628343946, 26.437165814810516, 21.357002873477235, 19.609986169626602, 23.538022993783436, 23.913025568805477]}
record3 = {"lpips": [0.45280157327651976, 0.23294542729854584, 0.13640966415405273, 0.2197905272245407, 0.12005699872970581, 0.05089030936360359, 0.045714226365089414, 0.060366328060626986, 0.07598078474402428, 0.07094187885522843, 0.09245808720588684, 0.0510644905269146, 0.05104268118739128, 0.05420913174748421, 0.10251523852348328], "psnr": [14.24109560269631, 16.829400727232812, 20.128308409061752, 18.59714560155995, 21.21019585953415, 26.097256828202365, 25.139542155351144, 21.140107595802572, 21.746779992466198, 18.53673908253635, 21.615859482243714, 24.902466669007424, 21.968935252442837, 22.245709166176205, 16.051053483544237]}
record4 = {"lpips": [0.45280157327651976, 0.21490054130554198, 0.19506693184375762, 0.2460673600435257, 0.11727307587862015, 0.09707947224378585, 0.08189650177955628, 0.1109785109758377, 0.10287002623081207, 0.053095822036266324, 0.07683735713362694, 0.10450900048017502, 0.06494000032544137, 0.2066912591457367], "psnr": [14.24109560269631, 17.53097503410042, 17.928595506997215, 14.687529170368197, 21.624185347976795, 20.29575832651705, 24.5721299672858, 19.552258527823035, 22.021158081571038, 25.49701813389455, 21.587221879680452, 17.645404471213908, 23.07429413592856, 18.392432140001596]}

# 30,nosche
# 30,sche
# 73,sche
# 73,nosche

plt.title("Lpips")
plt.plot(record1['lpips'], label="30, no schedule")
plt.plot(record2['lpips'], label="30, schedule")
plt.plot(record3['lpips'], label="73, schedule")
plt.plot(record4['lpips'], label="73, no schedule")
plt.legend(loc="upper right")
plt.savefig("lpips.png")

plt.clf()

plt.title("PSNR")
plt.plot(record1['psnr'], label="30, no schedule")
plt.plot(record2['psnr'], label="30, schedule")
plt.plot(record3['psnr'], label="73, schedule")
plt.plot(record4['psnr'], label="73, no schedule")
plt.legend(loc="upper right")
plt.savefig("psnr.png")